name: Build Computer Algebra System

on:
  push:
    branches: [BabinTest, main]
  pull_request:
    branches: [BabinTest, main]

jobs:
  build-linux:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Install Qt and dependencies
      run: |
        echo "ğŸ”§ Installing dependencies..."
        sudo apt-get update
        sudo apt-get install -y build-essential
        sudo apt-get install -y qt6-base-dev qt6-tools-dev qt6-tools-dev-tools
        sudo apt-get install -y g++ make

    - name: Build project
      run: |
        echo "ğŸ—ï¸ Building project..."
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ‡Ñ‚Ğ¾ Ğ²ÑÑ‘ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾
        qmake6 --version || qmake --version
        g++ --version
        make --version
        
        # Ğ¡Ğ±Ğ¾Ñ€ĞºĞ°
        qmake6 ComputerAlgebraSystem.pro || qmake ComputerAlgebraSystem.pro
        make -j4
        
        echo "âœ… Build completed"

    - name: Verify binary
      run: |
        echo "ğŸ” Looking for binary..."
        if [ -f "build/ComputerAlgebraSystem" ]; then
          echo "âœ… Binary found in build folder"
          cp build/ComputerAlgebraSystem .
          ls -la ComputerAlgebraSystem
          file ComputerAlgebraSystem
        elif [ -f "ComputerAlgebraSystem" ]; then
          echo "âœ… Binary found in root folder"
        else
          echo "âŒ Binary not found"
          find . -name "ComputerAlgebraSystem" -type f
          exit 1
        fi
        
    - name: Upload build artifacts
      uses: actions/upload-artifact@v4
      with:
        name: ComputerAlgebraSystem-Linux
        path: ComputerAlgebraSystem
        retention-days: 30

    - name: Show success message
      run: |
        echo ""
        echo "ğŸ‰ SUCCESS! ğŸ‰"
        echo "âœ… Linux build completed successfully!"
        echo "ğŸ“¦ Artifact: ComputerAlgebraSystem-Linux"
        echo "ğŸš€ Ready to download from Actions tab"
        echo ""